---
title: "Predicting Income Based on Religiosity"
format: 
  html:
    self-contained: true
    theme: materia
    code-fold: true
    mainfont: math
    code-tools: true
    toc: true
  gfm:
    code_fold: true
    code_tools: true
editor: source
editor_options: 
  chunk_output_type: console
---

```{r}

pacman::p_load(tidyverse)

```


## Link to the Relevant Python Code

[Here is a link](https://gist.github.com/danielstats/493384f1586c057156a0886624fb3bc8) to the Github Gist used for the actual Machine Learning aspect of this Machine Learning Project.

## Creating a USABLE dataset

This analysis will attempt to pull some meaningful information about income from respondent Religious preferences as well as some other, perhaps more traditional indicators of income status. The data for this analysis is sourced from the NORC General Social Survey, 2021 complete dataset, and then filtered dramatically down from 64814 observations of 6110 variables to about 5000 observations of close to 100 variables. This is done mainly for the purposes of easier data cleaning and due to limited resources (this computer is not very good and even if it was I don't have time to run 396,013,540 data points through every epoch!). There was some top down consideration made of which variables *might* be useful, but final selection of usefulness is of course left to the work of the neural network.

Because we are interested in predicting income for recent respondents, we will take as our target variable the respondent's income adjusted for inflation. By utilizing responses about religious preferences and other available variables, we hope to predict the individual's yearly income.

### Cobbling something together

```{r}

#| label: Read in and main wrangle
#| cache: true
GSS <- rio::import("GSS_spss/GSS7218_R3.sav")

gsd <- tibble(names = names(GSS), nas = map_dbl(GSS, function(x) sum(is.na(x))))

GSS_short <- GSS |> 
  filter(!(is.na(REALINC)))

gsd_short <- tibble(names = names(GSS_short), nas = map_dbl(GSS_short, function(x) sum(is.na(x))))

fin_vars <- gsd_short |> filter(nas < 1000) |> pull(names)

gss_fin <- GSS_short |> select(all_of(fin_vars)) |> select(-YEAR, -ID)


```

We now have **a** dataset. We will further reduce the number of variables before transitioning to python, where we will perform the one-hot encoding and final preparation of the variables we choose.

### Reducing the number of variables

We will remove other income based variables, those relating to the interviewer, and several other things that are ostensibly not useful:
```{r}
#| label: more wrangling and variable creation
#Remove other income-based variables 

gss_fina <- GSS_short |> 
  select(REALINC, WRKSTAT, WRKSLF, WRKGOVT, PRESTG10,PRESTG105PLUS, MARITAL,
         PAWRKSLF, SIBS, CHILDS, AGE, EDUC, MAEDUC, DEGREE, MADEG, SEX, RACE,
         RES16, REG16, MOBILE16, FAMILY16, MAWRKGRW, INCOM16, BORN, PARBORN, GRANBORN,
         HOMPOP, BABIES, PRETEEN, TEENS, ADULTS, EARNRS, REGION, SRCBELT,
         SIZE, PARTYID, PRES16, POLVIEWS, NATROAD, CAPPUN, COURTS, RELIG,
         FUND, ATTEND, RELITEN, POSTLIFE, PRAY, RELIG16, FUND16, BIBLE, HAPPY, WEEKSWRK,
         CLASS, PHONE, TVHOURS, GOD, REBORN, SAVESOUL, RELPERSN, SPRTPRSN) |> 
  filter(!is.na(SPRTPRSN), !is.na(MAEDUC), !is.na(INCOM16)) |> #filter down to a good size
  # Replace NAs with mean and create some binaries out of numericals
  mutate(TVHOURS = if_else(is.na(TVHOURS), mean(TVHOURS, na.rm = TRUE), TVHOURS),
         CHILDS  = if_else(CHILDS  %in% c(0, 9, NA), 0, 1),
         BABIES  = if_else(BABIES  %in% c(0, 9, NA), 0, 1),
         PRETEEN = if_else(PRETEEN %in% c(0, 9, NA), 0, 1),
         TEENS   = if_else(TEENS   %in% c(0, 9, NA), 0, 1),
         ADULTS  = if_else(ADULTS  %in% c(0, 9, NA), 0, 1),
         PAWRKSLF = case_when(PAWRKSLF %in% c(0, 8, 9, NA) ~ 0,
                              PAWRKSLF == 1 ~ 1,
                              PAWRKSLF == 2 ~ 2),
         WRKGOVT = case_when(WRKGOVT %in% c(0, 8, 9, NA) ~ 0,
                              WRKGOVT == 1 ~ 1,
                              WRKGOVT == 2 ~ 2),
         WRKSLF = case_when(WRKSLF %in% c(0, 8, 9, NA) ~ 0,
                            WRKSLF == 1 ~ 1,
                            WRKSLF == 2 ~ 2),
         POSTLIFE = case_when(POSTLIFE %in% c(0, 8, 9, NA) ~ 0,
                              POSTLIFE == 1 ~ 1,
                              POSTLIFE == 2 ~ 2)) |> 
  drop_na() #Finally, we drop the smaller number of NAs which are not worth my time to fix

# I should just make this a function, honestly
#gss_name2s <- tibble(names = names(gss_fina), nas = map_dbl(gss_fina, function(x) sum(is.na(x))))


#output final csv:
#write_csv(gss_fina, "analyses/income_ml/guess.csv")
```

### Transitioning to Python

Once transferred into Python, we will transform these variables into one-hot encoded dummies:

PRESTG10, MARITAL, PAWRKSLF, DEGREE, MADEG, SEX, RACE, RES16, REG16, MOBILE16, FAMILY16, MAWRKGRW, INCOM16, BORN, PARBORN, GRANBORN, HOMPOP, BABIES, PRETEEN, TEENS, ADULTS, EARNRS, REGION, SRCBELT, SIZE, PARTYID, PRES16, POLVIEWS, NATROAD, CAPPUN, COURTS, RELIG, FUND, ATTEND, RELITEN, POSTLIFE, PRAY, RELIG16, FUND16, BIBLE, HAPPY, CLASS, PHONE, GOD, REBORN, SAVESOUL, RELPERSN, SPRTPRSN

These variables will be treated as quantitative (as they are in fact ratio data!)
PRESTG10, SIBS, AGE, EDUC, MAEDUC, WEEKSWRK, TVHOURS


```{r}
cols <- "PRESTG10, MARITAL, PAWRKSLF, DEGREE, MADEG, SEX, RACE, RES16, REG16, MOBILE16, FAMILY16, MAWRKGRW, INCOM16, BORN, PARBORN, GRANBORN, HOMPOP, BABIES, PRETEEN, TEENS, ADULTS, EARNRS, REGION, SRCBELT, SIZE, PARTYID, PRES16, POLVIEWS, NATROAD, CAPPUN, COURTS, RELIG, FUND, ATTEND, RELITEN, POSTLIFE, PRAY, RELIG16, FUND16, BIBLE, HAPPY, CLASS, PHONE, GOD, REBORN, SAVESOUL, RELPERSN, SPRTPRSN"

str_replace_all(cols, ", ", "', '")

```


### Feature importance evaluation

Some more complex data wrangling was necessary to extract feature importances from the weights of the model after fitting. Therefore, we import a string of all importances and perform some wrangling to identify the most potent variables.

```{r}

features <- "0: 14.125269889831543
Feature 1: 18.340591430664062
Feature 2: 10.375503540039062
Feature 3: 17.95610237121582
Feature 4: 24.009769439697266
Feature 5: 6.335245132446289
Feature 6: 7.146548271179199
Feature 7: 8.95734691619873
Feature 8: 19.805953979492188
Feature 9: 8.9943208694458
Feature 10: 28.815052032470703
Feature 11: 42.83760070800781
Feature 12: 40.78019714355469
Feature 13: 13.996947288513184
Feature 14: 14.623912811279297
Feature 15: 45.60594177246094
Feature 16: 46.037540435791016
Feature 17: 18.47638702392578
Feature 18: 27.14275360107422
Feature 19: 28.088634490966797
Feature 20: 33.42060089111328
Feature 21: 25.431407928466797
Feature 22: 23.292123794555664
Feature 23: 24.946231842041016
Feature 24: 27.804370880126953
Feature 25: 10.240608215332031
Feature 26: 7.811041831970215
Feature 27: 23.147216796875
Feature 28: 7.915962219238281
Feature 29: 22.27239227294922
Feature 30: 10.768562316894531
Feature 31: 25.234493255615234
Feature 32: 43.73970031738281
Feature 33: 7.598076820373535
Feature 34: 14.70638656616211
Feature 35: 10.337671279907227
Feature 36: 23.72749137878418
Feature 37: 13.36570930480957
Feature 38: 7.221227169036865
Feature 39: 7.86398983001709
Feature 40: 16.16790008544922
Feature 41: 11.073763847351074
Feature 42: 18.09632110595703
Feature 43: 26.521141052246094
Feature 44: 12.582408905029297
Feature 45: 29.274757385253906
Feature 46: 8.192686080932617
Feature 47: 51.75959396362305
Feature 48: 27.207679748535156
Feature 49: 11.204548835754395
Feature 50: 26.2451171875
Feature 51: 7.455060958862305
Feature 52: 48.24290084838867
Feature 53: 33.52431106567383
Feature 54: 20.373960494995117
Feature 55: 37.38959503173828
Feature 56: 7.795746803283691
Feature 57: 12.39802360534668
Feature 58: 7.304072856903076
Feature 59: 11.628458976745605
Feature 60: 36.84385681152344
Feature 61: 30.71392822265625
Feature 62: 31.383472442626953
Feature 63: 47.189048767089844
Feature 64: 65.62699127197266
Feature 65: 18.770774841308594
Feature 66: 16.943370819091797
Feature 67: 54.43674087524414
Feature 68: 41.6557502746582
Feature 69: 7.384145736694336
Feature 70: 9.256141662597656
Feature 71: 81.3510513305664
Feature 72: 39.4312858581543
Feature 73: 15.028749465942383
Feature 74: 21.960256576538086
Feature 75: 8.621137619018555
Feature 76: 29.935039520263672
Feature 77: 6.660806655883789
Feature 78: 8.754758834838867
Feature 79: 8.250551223754883
Feature 80: 45.14249038696289
Feature 81: 13.868030548095703
Feature 82: 15.515182495117188
Feature 83: 25.666664123535156
Feature 84: 53.98981857299805
Feature 85: 8.953117370605469
Feature 86: 12.450990676879883
Feature 87: 12.772123336791992
Feature 88: 7.216913223266602
Feature 89: 24.1431941986084
Feature 90: 8.553458213806152
Feature 91: 6.128582954406738
Feature 92: 7.145368576049805
Feature 93: 6.304081439971924
Feature 94: 13.652729988098145
Feature 95: 8.846405982971191
Feature 96: 13.403484344482422
Feature 97: 9.612739562988281
Feature 98: 8.843098640441895
Feature 99: 18.66939926147461
Feature 100: 11.649259567260742
Feature 101: 18.447921752929688
Feature 102: 15.44387435913086
Feature 103: 7.408782958984375
Feature 104: 9.724823951721191
Feature 105: 17.884166717529297
Feature 106: 18.06340217590332
Feature 107: 10.974750518798828
Feature 108: 14.178955078125
Feature 109: 12.972883224487305
Feature 110: 10.593992233276367
Feature 111: 6.2093095779418945
Feature 112: 8.013530731201172
Feature 113: 8.560802459716797
Feature 114: 34.94133377075195
Feature 115: 7.7926106452941895
Feature 116: 7.683196067810059
Feature 117: 9.645837783813477
Feature 118: 6.895687103271484
Feature 119: 8.543675422668457
Feature 120: 9.021409034729004
Feature 121: 7.460252285003662
Feature 122: 9.39294147491455
Feature 123: 11.38136100769043
Feature 124: 7.889691352844238
Feature 125: 10.134756088256836
Feature 126: 9.686347961425781
Feature 127: 26.365861892700195
Feature 128: 7.298086166381836
Feature 129: 8.067554473876953
Feature 130: 8.00098991394043
Feature 131: 9.392505645751953
Feature 132: 18.219608306884766
Feature 133: 48.90271759033203
Feature 134: 35.651641845703125
Feature 135: 8.779327392578125
Feature 136: 5.884164810180664
Feature 137: 10.890691757202148
Feature 138: 6.970200538635254
Feature 139: 13.356040954589844
Feature 140: 17.79186248779297
Feature 141: 15.985872268676758
Feature 142: 7.624643802642822
Feature 143: 22.970651626586914
Feature 144: 9.676520347595215
Feature 145: 22.37363624572754
Feature 146: 39.82466125488281
Feature 147: 31.401371002197266
Feature 148: 25.203350067138672
Feature 149: 19.060691833496094
Feature 150: 14.847077369689941
Feature 151: 34.64771270751953
Feature 152: 19.106246948242188
Feature 153: 25.414548873901367
Feature 154: 9.639596939086914
Feature 155: 26.029151916503906
Feature 156: 7.630620002746582
Feature 157: 8.240981101989746
Feature 158: 8.557184219360352
Feature 159: 11.806246757507324
Feature 160: 26.181232452392578
Feature 161: 7.383023738861084
Feature 162: 50.863441467285156
Feature 163: 16.081056594848633
Feature 164: 26.011913299560547
Feature 165: 62.840179443359375
Feature 166: 72.54932403564453
Feature 167: 79.77525329589844
Feature 168: 56.294639587402344
Feature 169: 29.626590728759766
Feature 170: 14.682089805603027
Feature 171: 15.261423110961914
Feature 172: 10.718846321105957
Feature 173: 8.741230010986328
Feature 174: 7.266488552093506
Feature 175: 9.074755668640137
Feature 176: 23.729904174804688
Feature 177: 7.6199846267700195
Feature 178: 6.866671085357666
Feature 179: 8.078213691711426
Feature 180: 9.280387878417969
Feature 181: 7.043240547180176
Feature 182: 38.532203674316406
Feature 183: 16.301361083984375
Feature 184: 15.235567092895508
Feature 185: 21.427988052368164
Feature 186: 25.320770263671875
Feature 187: 16.295486450195312
Feature 188: 9.39090347290039
Feature 189: 8.438216209411621
Feature 190: 16.489402770996094
Feature 191: 30.396774291992188
Feature 192: 35.56297302246094
Feature 193: 16.444250106811523
Feature 194: 13.783316612243652
Feature 195: 14.969709396362305
Feature 196: 6.818073272705078
Feature 197: 43.08305740356445
Feature 198: 14.610426902770996
Feature 199: 29.0684814453125
Feature 200: 63.76873016357422
Feature 201: 12.29869270324707
Feature 202: 10.470512390136719
Feature 203: 17.987125396728516
Feature 204: 13.19317626953125
Feature 205: 14.292890548706055
Feature 206: 65.44867706298828
Feature 207: 8.865989685058594
Feature 208: 40.02379608154297
Feature 209: 11.607995986938477
Feature 210: 7.8130292892456055
Feature 211: 7.0543365478515625
Feature 212: 25.36477279663086
Feature 213: 35.6121711730957
Feature 214: 27.726455688476562
Feature 215: 6.8487229347229
Feature 216: 20.60177993774414
Feature 217: 84.66020202636719
Feature 218: 24.248123168945312
Feature 219: 19.27178382873535
Feature 220: 14.22519302368164
Feature 221: 24.488431930541992
Feature 222: 22.804584503173828
Feature 223: 20.40981101989746
Feature 224: 17.625858306884766
Feature 225: 16.122421264648438
Feature 226: 20.857513427734375
Feature 227: 45.702964782714844
Feature 228: 33.79528045654297
Feature 229: 46.893882751464844
Feature 230: 20.629016876220703
Feature 231: 27.551197052001953
Feature 232: 21.838096618652344
Feature 233: 47.84247589111328
Feature 234: 19.97088050842285
Feature 235: 20.55084228515625
Feature 236: 9.651863098144531
Feature 237: 8.40115737915039
Feature 238: 14.983799934387207
Feature 239: 17.96157455444336
Feature 240: 17.908023834228516
Feature 241: 35.74960708618164
Feature 242: 8.282392501831055
Feature 243: 13.17580795288086
Feature 244: 7.122766494750977
Feature 245: 14.46023941040039
Feature 246: 29.02382469177246
Feature 247: 14.463939666748047
Feature 248: 46.75316619873047
Feature 249: 25.38592529296875
Feature 250: 41.937713623046875
Feature 251: 32.419532775878906
Feature 252: 14.044770240783691
Feature 253: 33.41539001464844
Feature 254: 13.204343795776367
Feature 255: 55.459861755371094
Feature 256: 38.02622604370117
Feature 257: 53.95005416870117
Feature 258: 10.393416404724121
Feature 259: 8.311525344848633
Feature 260: 24.867422103881836
Feature 261: 42.32084655761719
Feature 262: 14.521169662475586
Feature 263: 16.738784790039062
Feature 264: 7.294400215148926
Feature 265: 59.021263122558594
Feature 266: 10.539985656738281
Feature 267: 47.82150650024414
Feature 268: 34.86365509033203
Feature 269: 11.971389770507812
Feature 270: 62.44484329223633
Feature 271: 42.10192108154297
Feature 272: 59.12681198120117
Feature 273: 24.63615608215332
Feature 274: 60.104591369628906
Feature 275: 31.120628356933594
Feature 276: 52.91199493408203
Feature 277: 19.97586441040039
Feature 278: 9.300052642822266
Feature 279: 10.279436111450195
Feature 280: 54.66516876220703
Feature 281: 25.40110206604004
Feature 282: 47.11653137207031
Feature 283: 30.637060165405273
Feature 284: 5.99892520904541
Feature 285: 26.277341842651367
Feature 286: 47.17148971557617
Feature 287: 35.14868927001953
Feature 288: 17.647846221923828
Feature 289: 27.005340576171875
Feature 290: 52.42927551269531
Feature 291: 44.9049186706543
Feature 292: 33.13072204589844
Feature 293: 20.21726417541504
Feature 294: 47.7215576171875
Feature 295: 22.13475799560547
Feature 296: 28.15277862548828
Feature 297: 9.285164833068848
Feature 298: 22.58355140686035
Feature 299: 27.072513580322266
Feature 300: 29.402572631835938
Feature 301: 15.981447219848633
Feature 302: 13.197700500488281
Feature 303: 41.36077880859375
Feature 304: 38.86270523071289
Feature 305: 24.09711265563965
Feature 306: 41.32146072387695
Feature 307: 37.967262268066406
Feature 308: 49.366127014160156
Feature 309: 26.68284797668457
Feature 310: 42.65669250488281
Feature 311: 17.421695709228516
Feature 312: 43.53535842895508
Feature 313: 34.42595291137695
Feature 314: 12.88998031616211
Feature 315: 47.27655029296875
Feature 316: 18.9344425201416
Feature 317: 42.346954345703125
Feature 318: 26.924528121948242
Feature 319: 10.114166259765625
Feature 320: 45.752952575683594
Feature 321: 24.44942855834961
Feature 322: 34.679927825927734
Feature 323: 42.191062927246094
Feature 324: 26.761959075927734
Feature 325: 27.90347671508789
Feature 326: 39.414146423339844
Feature 327: 18.90203857421875
Feature 328: 52.198814392089844
Feature 329: 17.75891876220703
Feature 330: 59.532958984375
Feature 331: 6.972165584564209
Feature 332: 6.761302471160889
Feature 333: 48.17789840698242
Feature 334: 19.088333129882812
Feature 335: 9.405369758605957
Feature 336: 59.503265380859375
Feature 337: 8.519121170043945
Feature 338: 8.834009170532227
Feature 339: 28.75784683227539
Feature 340: 10.523580551147461
Feature 341: 29.488468170166016
Feature 342: 30.441030502319336
Feature 343: 27.967811584472656
Feature 344: 18.869937896728516
Feature 345: 32.442535400390625
Feature 346: 24.829151153564453
Feature 347: 40.8077392578125
Feature 348: 29.09954071044922
Feature 349: 34.960357666015625
Feature 350: 28.561405181884766
Feature 351: 42.78730773925781
Feature 352: 15.43963623046875
Feature 353: 9.127336502075195
Feature 354: 16.74661636352539
Feature 355: 15.777955055236816
Feature 356: 28.56562042236328
Feature 357: 32.50090026855469
Feature 358: 26.1024227142334
Feature 359: 46.36741256713867
Feature 360: 31.082351684570312
Feature 361: 26.049076080322266
Feature 362: 19.438323974609375
Feature 363: 42.92578887939453
Feature 364: 33.607643127441406
Feature 365: 35.755409240722656
Feature 366: 30.265928268432617
Feature 367: 8.940523147583008
Feature 368: 27.188831329345703
Feature 369: 54.5855598449707
Feature 370: 30.784561157226562
Feature 371: 37.96106719970703
Feature 372: 19.06238555908203
Feature 373: 20.33051109313965
Feature 374: 38.301109313964844
Feature 375: 50.988800048828125
Feature 376: 67.69792175292969
Feature 377: 45.94327926635742
Feature 378: 66.42982482910156
Feature 379: 33.17182159423828
Feature 380: 16.08705711364746
Feature 381: 12.700960159301758
Feature 382: 19.606863021850586
Feature 383: 19.495121002197266
Feature 384: 21.770301818847656
Feature 385: 8.005228042602539
Feature 386: 16.88578224182129
Feature 387: 55.625423431396484
Feature 388: 40.2880859375
Feature 389: 62.33898162841797
Feature 390: 41.970001220703125
Feature 391: 46.16672897338867
Feature 392: 74.62911987304688
Feature 393: 19.253347396850586
Feature 394: 35.137611389160156
Feature 395: 57.30064010620117
Feature 396: 36.35246276855469
Feature 397: 15.81341552734375
Feature 398: 8.242683410644531
Feature 399: 6.266489505767822
Feature 400: 14.156158447265625
Feature 401: 23.277700424194336
Feature 402: 41.923973083496094
Feature 403: 20.93069839477539
Feature 404: 41.202911376953125
Feature 405: 28.746105194091797
Feature 406: 36.57301330566406
Feature 407: 26.819082260131836
Feature 408: 31.908475875854492
Feature 409: 30.32102394104004
Feature 410: 8.056529998779297
Feature 411: 61.73354721069336
Feature 412: 12.16042709350586
Feature 413: 6.898834228515625
Feature 414: 10.748861312866211
Feature 415: 6.579460620880127
Feature 416: 8.218963623046875
Feature 417: 13.22542667388916
Feature 418: 13.021244049072266
Feature 419: 16.739173889160156
Feature 420: 19.91688346862793
Feature 421: 7.337054252624512
Feature 422: 6.679235458374023
Feature 423: 6.102063179016113
Feature 424: 6.287738800048828
Feature 425: 5.951620101928711
Feature 426: 5.949444770812988
Feature 427: 5.952885627746582
Feature 428: 13.115103721618652
Feature 429: 6.9979248046875
Feature 430: 7.102205276489258
Feature 431: 7.7563090324401855
Feature 432: 18.40601921081543
Feature 433: 9.732390403747559
Feature 434: 21.555015563964844
Feature 435: 11.44908332824707
Feature 436: 7.119816303253174
Feature 437: 16.192768096923828
Feature 438: 7.767492294311523
Feature 439: 7.8517537117004395
Feature 440: 11.390830993652344
Feature 441: 9.968986511230469
Feature 442: 7.9370622634887695
Feature 443: 8.615175247192383
Feature 444: 12.382976531982422
Feature 445: 13.140637397766113
Feature 446: 7.3165178298950195
Feature 447: 6.1036376953125
Feature 448: 9.469362258911133
Feature 449: 9.151470184326172
Feature 450: 9.562219619750977
Feature 451: 7.341841697692871
Feature 452: 8.625204086303711
Feature 453: 7.8794169425964355
Feature 454: 13.795217514038086
Feature 455: 7.913626670837402
Feature 456: 8.499845504760742
Feature 457: 10.371932983398438
Feature 458: 9.850971221923828
Feature 459: 9.350563049316406
Feature 460: 9.965532302856445
Feature 461: 11.878742218017578
Feature 462: 6.691295623779297
Feature 463: 7.06866979598999
Feature 464: 10.664724349975586
Feature 465: 6.660884857177734
Feature 466: 9.472759246826172
Feature 467: 7.894168853759766
Feature 468: 11.738258361816406
Feature 469: 10.147738456726074
Feature 470: 9.226043701171875
Feature 471: 7.347048759460449
Feature 472: 17.732025146484375
Feature 473: 8.898747444152832
Feature 474: 7.273982524871826
Feature 475: 8.439103126525879
Feature 476: 7.234737873077393
Feature 477: 20.30660629272461
Feature 478: 16.130247116088867
Feature 479: 26.781356811523438
Feature 480: 12.883426666259766
Feature 481: 8.529115676879883
Feature 482: 7.645881175994873
Feature 483: 6.803022384643555
Feature 484: 9.128462791442871
Feature 485: 8.52444839477539
Feature 486: 11.635183334350586
Feature 487: 7.1921515464782715
Feature 488: 26.101085662841797
Feature 489: 7.223467826843262
Feature 490: 28.276695251464844
Feature 491: 52.6238899230957
Feature 492: 38.66847229003906
Feature 493: 15.613100051879883
Feature 494: 103.46896362304688
Feature 495: 13.805529594421387
Feature 496: 11.002775192260742
Feature 497: 10.359390258789062
Feature 498: 41.971527099609375
Feature 499: 14.515628814697266
Feature 500: 7.064837455749512
Feature 501: 8.674568176269531
Feature 502: 9.878839492797852
Feature 503: 15.665362358093262
Feature 504: 14.36319351196289
Feature 505: 11.075764656066895
Feature 506: 6.916975021362305
Feature 507: 7.115577697753906
Feature 508: 7.260022163391113
Feature 509: 8.431227684020996
Feature 510: 8.067532539367676
Feature 511: 12.534599304199219
Feature 512: 8.123753547668457
Feature 513: 21.210391998291016
Feature 514: 9.25775146484375
Feature 515: 7.094631195068359
Feature 516: 7.157505989074707
Feature 517: 7.899926662445068"

feature <- tibble(feat = unlist(str_split(features, pattern = "\nFeature "))) |> 
  separate(feat, into = c("feature", "importance"), sep = ": ") |>
  mutate(importance = as.numeric(importance)) |> 
  arrange(-importance)

head(feature, 20)

```

